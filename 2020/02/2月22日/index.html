<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>无线持续交付平台助力移动端开发 | Pollex Lee</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">无线持续交付平台助力移动端开发</h1><a id="logo" href="/.">Pollex Lee</a><p class="description">给未来的你</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">无线持续交付平台助力移动端开发</h1><div class="post-meta">Feb 22, 2020</div><div class="post-content"><blockquote>
<p>重复造轮子是不好，但是适合自己的轮子才是最好的。</p>
</blockquote>
<p>携程开发总监 <em>刘李丰</em>如是说。</p>
<p><a href="https://time.geekbang.org/dailylesson/detail/100020732" target="_blank" rel="noopener">《携程无线技术平台化研发实践》</a>的学习笔记。</p>
<a id="more"></a>
<h3 id="持续交付平台-MCD"><a href="#持续交付平台-MCD" class="headerlink" title="持续交付平台 - MCD"></a>持续交付平台 - MCD</h3><ul>
<li>MCD之前<ul>
<li>专人打包</li>
<li>最多2-3个包 per day</li>
<li>开发测试流程完成通过人工协调</li>
<li>发版时迟迟不能定版</li>
<li>最和新问题：没有版本信息，包名相同，自动化测试不清楚验证包信息</li>
</ul>
</li>
<li>MCD 1.0<ul>
<li>解放生产力，随时打包</li>
<li>自动化流程，打包流程由环境演变成pipeline</li>
<li>CI/CD<ul>
<li>定时打包</li>
<li>代码扫描</li>
<li>自动化验证包 - 白屏检测</li>
</ul>
</li>
</ul>
</li>
<li>持续继承 + 冒烟测试<ul>
<li>代码扫描 infer &amp; sonar</li>
<li>冒烟测试<ul>
<li>多机型兼容测试</li>
<li>页面内容长度 + 图像比对</li>
</ul>
</li>
</ul>
</li>
<li>超级App改造<ul>
<li>同一个代码库</li>
<li>基于源码打包，编译错误阻塞打包</li>
<li>打包时间仍然过长，8分钟</li>
</ul>
</li>
<li>超级App改造 - MCD 2.0<ul>
<li>重新定义MCD<ul>
<li>集成</li>
<li>测试</li>
<li>发布</li>
<li>运营</li>
</ul>
</li>
<li>基于Bundle打包<ul>
<li>引入Bundle发布状态（L，RC）</li>
</ul>
</li>
<li>进一步优化流程<ul>
<li>从项目创建覆盖到定版</li>
</ul>
</li>
<li>急速出包<ul>
<li>2-3分钟</li>
</ul>
</li>
</ul>
</li>
<li>发布升级<ul>
<li>发布对象<ul>
<li>hotfix</li>
<li>Bundle</li>
<li>Hybrid/RN</li>
</ul>
</li>
<li>升级之路<ul>
<li>存储云化</li>
<li>灰度发布<ul>
<li>白名单/百分比</li>
</ul>
</li>
<li>差分<ul>
<li>全量</li>
<li>文本</li>
<li>二进制</li>
<li>动态差分</li>
</ul>
</li>
<li>实时查看<ul>
<li>基于设备ID查看</li>
<li>整体趋势</li>
</ul>
</li>
</ul>
</li>
<li>配置中心<ul>
<li>移动端配置中心化<ul>
<li>支持平台，版本，渠道下发</li>
<li>支持分流，AB</li>
<li>App启动全量拉取</li>
</ul>
</li>
</ul>
</li>
<li>崩溃收集<ul>
<li>Bugly很专业，无法定制</li>
<li>基于代码打标签，MCD无缝对接</li>
<li>实时报警</li>
<li>多维度搜索</li>
<li>各种样式Dashboard</li>
</ul>
</li>
<li>App Size管理<ul>
<li>基于业务线模块进行统计<ul>
<li>和历史版本比较</li>
<li>各自比较</li>
</ul>
</li>
<li>刨除法计算</li>
</ul>
</li>
<li>MCD Arch<ul>
<li>Not Just Jenkins<ul>
<li>MQ 解决 Jenkins Cluster</li>
</ul>
</li>
<li>支撑数量<ul>
<li>打包：10000+ 每年</li>
<li>发布：10000+ 每年</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="性能监控平台-APM"><a href="#性能监控平台-APM" class="headerlink" title="性能监控平台 - APM"></a>性能监控平台 - APM</h3><ul>
<li>APM背景<ul>
<li>缺乏质量大盘</li>
<li>缺乏精细化运营数据</li>
<li>缺乏多维度查看数据</li>
<li>Hive拉取数据过漫</li>
</ul>
</li>
<li>APM质量大盘<ul>
<li>网络性能</li>
<li>网络成功率</li>
<li>崩溃率</li>
<li>启动时间</li>
<li>定位成功率</li>
</ul>
</li>
<li>APM多维度分析<ul>
<li>热门地区</li>
<li>运营商</li>
<li>网络</li>
</ul>
</li>
<li>APM服务大盘<ul>
<li>成功率</li>
<li>耗时</li>
<li>请求大小</li>
<li>报文大小</li>
<li>Error code占比</li>
</ul>
</li>
<li>APM报警<ul>
<li>设定阈值</li>
<li>与上周数据比较</li>
<li>有问题数据进行冒烟</li>
</ul>
</li>
<li>精细化运营 - Server IP下发<ul>
<li>背景<ul>
<li>运营商 网络质量存在差异</li>
</ul>
</li>
<li>方案<ul>
<li>海外：国家</li>
<li>国内：城市</li>
</ul>
</li>
<li>目标<ul>
<li>下发高质量的IP列表</li>
</ul>
</li>
<li>测试结果<ul>
<li>成功率1个点提升</li>
</ul>
</li>
</ul>
</li>
<li>踩过的坑<ul>
<li>噪音数据过滤</li>
<li>数据处理性能，延迟监控<ul>
<li>埋点监控</li>
</ul>
</li>
<li>数据处理的准确性<ul>
<li>Hive数据比对</li>
</ul>
</li>
<li>数据Trade off<ul>
<li>无线请求可以花粉为App版本、平台、网络类型、国家、城市等</li>
<li>维度降低</li>
</ul>
</li>
</ul>
</li>
<li>设计细节<ul>
<li>Metric 100+</li>
<li>日处理数据量 100亿+</li>
<li>写入数据量 100GB+</li>
<li>处理流程：<ul>
<li>app采集数据 -&gt; Storm数据清洗聚合 -&gt; DownSample数据归集 -&gt; ES数据存储 -&gt; Dashboard数据展示</li>
</ul>
</li>
</ul>
</li>
<li>Down sample设计<ul>
<li>多级聚合</li>
<li>错误监听</li>
<li>状态监听</li>
</ul>
</li>
</ul>
<h3 id="日志排障平台-MTS"><a href="#日志排障平台-MTS" class="headerlink" title="日志排障平台 - MTS"></a>日志排障平台 - MTS</h3><ul>
<li>MTS背景</li>
<li>全链路打通<ul>
<li>Native App TCP服务调用</li>
<li>Hybrid/H5 调用</li>
<li>Base Page请求</li>
<li>图片请求</li>
<li>用户轨迹流，崩溃路径</li>
<li>用户服务访问流程，各自的报文</li>
</ul>
</li>
</ul>
<h3 id="无线技术平台-MTP"><a href="#无线技术平台-MTP" class="headerlink" title="无线技术平台 - MTP"></a>无线技术平台 - MTP</h3><ul>
<li><p>无线平台建设背景</p>
<ul>
<li>缺乏Meta信息维护</li>
<li>重复造轮子，质量不高</li>
<li>研发效率不高，App代码导出拷贝</li>
<li>缺乏通用解决方案</li>
</ul>
</li>
<li><p>移动技术产品</p>
<ul>
<li>Platform</li>
<li>Communication</li>
<li>Framework</li>
<li>Business</li>
</ul>
</li>
<li><p>通用技术方案</p>
<ul>
<li>MTP 注册应用，组件，开发控制台</li>
<li>MCD 集成，测试，发布</li>
<li>APM 运营，监控</li>
<li>MTS 排障</li>
</ul>
</li>
<li><p>MTP控制台</p>
</li>
<li><p>平台治理</p>
<ul>
<li><p>开放</p>
<ul>
<li>注册服务，注册回调</li>
</ul>
</li>
<li><p>排障</p>
<ul>
<li>查询数据及调用链</li>
</ul>
</li>
<li><p>熔断</p>
<ul>
<li>服务请求过载</li>
</ul>
</li>
<li><p>报告</p>
<ul>
<li>查看调用</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="未来方向"><a href="#未来方向" class="headerlink" title="未来方向"></a>未来方向</h3><ul>
<li>打造无线中台</li>
<li>大数据赋能</li>
</ul>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Pollex Lee</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2020/02/2月22日/">http://blog.pollex.me/2020/02/2月22日/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>内容版权属于 Pollex Lee 所有。未经授权，不得转载。</li></ul></div><br><div class="tags"><a href="/tags/Android/">Android</a><a href="/tags/30天学习打卡/">30天学习打卡</a></div><div class="post-nav"><a class="pre" href="/2020/02/2月23日/">端智能是什么？</a><a class="next" href="/2020/02/2月21日/">越复杂的需求，就要做越简单的设计</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://blog.pollex.me"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/30天学习打卡/" style="font-size: 15px;">30天学习打卡</a> <a href="/tags/Flutter/" style="font-size: 15px;">Flutter</a> <a href="/tags/service/" style="font-size: 15px;">service</a> <a href="/tags/Android高手进阶视频/" style="font-size: 15px;">Android高手进阶视频</a> <a href="/tags/笔记/" style="font-size: 15px;">笔记</a> <a href="/tags/String/" style="font-size: 15px;">String</a> <a href="/tags/排序/" style="font-size: 15px;">排序</a> <a href="/tags/字符串/" style="font-size: 15px;">字符串</a> <a href="/tags/bug/" style="font-size: 15px;">bug</a> <a href="/tags/Resources-arsc/" style="font-size: 15px;">Resources.arsc</a> <a href="/tags/Application/" style="font-size: 15px;">Application</a> <a href="/tags/Activity/" style="font-size: 15px;">Activity</a> <a href="/tags/label/" style="font-size: 15px;">label</a> <a href="/tags/EditText/" style="font-size: 15px;">EditText</a> <a href="/tags/gradle/" style="font-size: 15px;">gradle</a> <a href="/tags/Windows/" style="font-size: 15px;">Windows</a> <a href="/tags/Android开发艺术探索/" style="font-size: 15px;">Android开发艺术探索</a> <a href="/tags/事件分发/" style="font-size: 15px;">事件分发</a> <a href="/tags/c语言/" style="font-size: 15px;">c语言</a> <a href="/tags/Data-Binding/" style="font-size: 15px;">Data Binding</a> <a href="/tags/翻译/" style="font-size: 15px;">翻译</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/WebView/" style="font-size: 15px;">WebView</a> <a href="/tags/NDK/" style="font-size: 15px;">NDK</a> <a href="/tags/jni/" style="font-size: 15px;">jni</a> <a href="/tags/ssh/" style="font-size: 15px;">ssh</a> <a href="/tags/scp/" style="font-size: 15px;">scp</a> <a href="/tags/vps/" style="font-size: 15px;">vps</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/Hook/" style="font-size: 15px;">Hook</a> <a href="/tags/反射/" style="font-size: 15px;">反射</a> <a href="/tags/Fiddler/" style="font-size: 15px;">Fiddler</a> <a href="/tags/优化/" style="font-size: 15px;">优化</a> <a href="/tags/Kotlin/" style="font-size: 15px;">Kotlin</a> <a href="/tags/转载/" style="font-size: 15px;">转载</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月26日/">Fuchsia - 来自 Google 的全新开源操作系统</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月25日/">在浏览器上打王者荣耀？</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月24日/">AR发展，未来可期</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月23日/">端智能是什么？</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月22日/">无线持续交付平台助力移动端开发</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月21日/">越复杂的需求，就要做越简单的设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月20日/">没有办法一劳永逸，所以我们面面俱到</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月19日/">基于AAB的插件化方案：Qigsaw</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月18日/">秒开秒用，用完即走</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/2月17日/">Android插件化路在何方</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Pollex Lee.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>